tail(trueStatus)
tail(trueStatus)
table(pValues2 < 0.05, trueStatus)
pValues<0.05
24/500
24/500
table(p.adjust(pValues2,method="bonferroni") < 0.05, trueStatus)
table(p.adjust(pValues2,method="bonferroni") < 0.05, trueStatus)
table(p.adjust(pValues2,method="BH") < 0.05, trueStatus)
die
3.5
print(g2)
head(sh)
length(sh)
nh
median(resampledMeans)
median(resampledMedians)
median(sh)
sam<- sample(fh, nh*B,replace = TRUE)
resam <-matrix(sam)
resam <-matrix(sam,B,nh)
resam <-matrix(sam,B,nh)
meds <- apply(resam,1,median)
median(fh)-median(meds)
sd(meds)
sd(resampledMedians)
sd(resampledMedians)
quantile(resampledMedians,c(.025,.975))
meds
quantile(meds,c(.025,.975))
dim(InsectSprays)
names(InsectSprays)
range(Bdata$count)
range(Bdata$)
range(InsectSprays$C)
range(Cdata$count)
BCcounts
group
group
testStat()
testStat
testStat
obs <- testStat(BCcounts,group)
obs
obs
mean(Bdata$count)-mean(Cdata$count)
sample
sample()
sample(group)
perms<-<- sapply(1 : 10000, function(i) testStat(BCcounts, sample(group)))
perms<-sapply(1 : 10000, function(i) testStat(BCcounts, sample(group)))
perms>obs
mean(perms>obs)
testStat(DEcounts,group)
testStat(DEcounts,group)
perms <- sapply(1 : 10000, function(i) testStat(DEcounts, sample(group)))
install.packages("Latex")
R: tinytex::install_tinytex()
tinytex::install_tinytex()
library(swirl)
install_from_swirl("Regression Models")
swirl()
plot(child ~ parent, galton)
plot(jitter(child,4) ~ parent, galton)
regrline <- lm(child ~ parent, galton)
abline(regrline, lwd=3, col='red')
summary(regline)
summary(regrrline)
summary(regrline)
fit <- lm(child~parent)
fit <- lm(child~parent,galton)
summary(fit)
mean(fit$residuals)
cov(fit$residuals, galton$parent)
ols.ic <- fit$coef
ols.ic <- fit$coef[1]
ols.slope <- fit$coef[2]
lhs-rhs
all.equal()
all.equal(lhs,rhs)
varchild <- var(child$height)
varchild <- var(galton$child)
varChild <- var(galton$child)
varRes <- var(fit$residuals)
varEst <- var(est(ols.slope,ols.ic))
all.equal(varRes,varEst)
all.equal(varChild, varEst+varRes)
efit <- lm(accel ~ mag+dist,attenu)
mean(efit$residuals)
cov(attenu$mag)
cov(predictor,attenu$mag)
cov(efit$residuals,attenu$mag)
cov(efit$residuals,attenu$dist)
cor(galton$parent,galton$child)
cor(gpa_nor,gch_nor)
lm(child~parent,galton)
l_nor <- lm(gch_nor ~ gpa_nor)
x <- c(0.18, -1.54, 0.42, 0.95)
w <- c(2, 1, 3, 1)
reg<- lm(w~x)
plot(reg)
library(manipulate)
mse<- mean(x-1)
source('~/.active-rstudio-document', echo=TRUE)
library(ggplot2)
myhist<-function(mu){
mse<-mean((x-mu)^2)
g<- ggplot(aes(x))+geom_histogram(fill="blue",bindwidth=1,color="black")
g<-g+geom_vline(xintercept=mu,size=3)
g<- g+ggtitle(paste("mu=",mu,",MSE=",round(mse,2),sep=""))
g
}
manipulate(myhist(mu),mu=slider(62,74,step=0.5))
myhist<-function(mu){
mse<-mean((x-mu)^2)
g<- ggplot(aes(x=x,y=w))+geom_histogram(fill="blue",bindwidth=1,color="black")
g<-g+geom_vline(xintercept=mu,size=3)
g<- g+ggtitle(paste("mu=",mu,",MSE=",round(mse,2),sep=""))
g
}
manipulate(myhist(mu),mu=slider(62,74,step=0.5))
data<- matrix(x=x,y=w)
data
datax11())
x
w
d<-data.frame(x,w)
d
myhist<-function(mu){
mse<-mean((x-mu)^2)
g<- ggplot(data=d,aes(x=x,y=w))+geom_histogram(fill="blue",bindwidth=1,color="black")
g<-g+geom_vline(xintercept=mu,size=3)
g<- g+ggtitle(paste("mu=",mu,",MSE=",round(mse,2),sep=""))
g
}
manipulate(myhist(mu),mu=slider(62,74,step=0.5))
source('~/.active-rstudio-document', echo=TRUE)
manipulate(myhist(mu),mu=slider(62,74,step=0.5))
w*(x-0.3)
sum(w*(x-0.3))
sum(w*(x-0.0025))
sum(w*(x-0.1471))
sum(w*(x-1.077))
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(x~y)
lm(y~x)
?lm
data("mtcars")
y=mtcars$mpg
x=mtcars$wt
lm(x~y)
lm(x~y,-1)
lm(y~x-1)
names(mtcars)
lm(x~y-1)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05
)
lm(y~x-1)
x <- c(8.58, 10.46, 9.01, 9.64, 8.86)
l<-x_mean(x)
l<-x-mean(x)
sd(x)
l/sd(x)
mean(l/sd(x))
sd(l/sd(x))
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(y~x)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
x-mean(x)
mean(x)
sum((x-0.8)^2)
sum((x-0.573)^2)
sum((x-0.36)^2)
sum((x-0.44)^2)
library(swirl)
swirl()
swirl()
fit <- lm(child~parent)
fit <- lm("child~parent",galton)
fit <- lm(child~parent,galton)
residuals(fit$residuals)
resid(fit$residuals)
resid(fit)
sqrt(sum(fit$residuals^2) / (n - 2))
summary(fit)$sigma
sqrt(deviance(fit)/(n-2))
mean(galton$child)
mu<-mean(galton$child)
galton$child-mu
sTot <- sum((galton$child-mu)^2)
sRes <- sum(fit$residuals)
sRes <- deviance(fit)
sRes/sTot
1-sRes/sTot
summary(fit)
summary(fit)$r.squared
cor(galton$child,galton$parent)^2
fit <- lm(child~parent,galton)
sum((fit$residuals)^2)/(n-2)
sqrt(sum((fit$residuals)^2)/(n-2))
sqrt(sum((fit$residuals)^2)/(n-2)))
sqrt(sum((fit$residuals)^2)/(n-2))
sqrt(sum(fit$residuals^2)/(n-2))
sigma
summary(fit)$sigma
sqret(deviance(fit)/(n-2))
sqrt(deviance(fit)/(n-2))
0
0
swirl()
ones  <- rep(1,nrow(galton))
lm(child~parent-1,galton)
lm(child~ones+parent-1,galton)
lm(child~parent,galton)
lm(child ~ 1, galton)
lm(child ~ 1, galton)
View(trees)
fit <- lm(Volume ~ Girth + Height + Constant -1, trees)
trees2 <- eliminate("Girth",trees)
view(trees2)
head(trees2)
fit2 <- lm(Volume~Height+Constant-1)
fit2 <- lm(Volume~Height+Constant-1,trees2)
lapply(list(fit, fit2), coef)
lm(Feritlity~Agriculture+examination+Education+Catholic+Infant.Mortality-1,swiss)
lm(Fertility~Agriculture+examination+Education+Catholic+Infant.Mortality-1,swiss)
lm(Fertility~Agriculture+Examination+Education+Catholic+Infant.Mortality-1,swiss)
all <- lm(Fertility ~ ., swiss)
summary(all)
lm(Fertility~Agriculture,swiss)
summary(lm(Fertility~Agriculture,swiss))
cor(swiss$Examination,swiss$Education)
cor(swiss$Agriculture,swiss$Education)
makelms()
ec <- sum(swiss$Examination)+sum(Catholic)
ec <- sum(swiss$Examination)+sum(swiss$Catholic)
ec <- swiss$Examination+swiss$Catholic
.+ec
efit<- lm(Fertility~.+ec,swiss)
efit<- lm(Fertility~.+ec,swiss)
all$coefficients-efit$coefficients
install.packages(oro.dicom)
install.packages()
x <- c(0.61, 0.93, 0.83, 0.35, 0.54, 0.16, 0.91, 0.62, 0.62)
y <- c(0.67, 0.84, 0.6, 0.18, 0.85, 0.47, 1.1, 0.65, 0.36)
fit<- lm(y~x)
tp(0.95,fit)
summary
(fit)
summary(fit)
pt(fit$Estimate)
?pt
fit$Estimate
data("mtcars")
fit<-lm(mpg~weight,mtcars)
fit<-lm(mpg~wt,mtcars)
mean<- data.frame(mwt=mean(mtcars$wt))
predict(fit,mean,interval="Confidence")
predict(fit,mean,interval="confidence")
names(mtcars)
fit
m<- data.frame(mwt=mean(mtcars$wt))
m
predict(fit,m,interval="confidence")
m<- data.frame(wt=mean(mtcars$wt))
predict(fit,m,interval="confidence")
?predict
deviance(fit)
predict(fit,data.frame(3),interval="confidence")
data.frame(3)
predict(fit,data.frame(wt=3),interval="confidence")
predict(fit,data.frame(wt=3),interval="predict")
resid(fit)
deviance(fit)
fit
require(datasets)
require(insectsprays)
require(insectprays)
require(InsectSprays)
library(datasets)
library(InsectSprays)
datasets::InsectSprays
datasets(InsectSprays)
dataset(InsectSprays)
InsectSprays
library(dplyr)
y<-InsectSprays
y %>% groupby(spray) %>% summarize(y)
y %>% group_by(spray) %>% summarize(spray)
y %>% group_by(spray) %>% summarize(mn=mean(count))
?influence.influence.measures
?influence.measures
library(swirl)
shiv
swiirl()
swirl()
head(InsectSprays)
dim(InsectSprays)
head(InsectSprays)
head(InsectSprays,15)
A
count
sx
sA
summary(InsectSprays,2)
summary(InsectSprays[,2])
sapply(InsectSprays,1, class)
sapply(InsectSprays,1,)
sapply(InsectSprays,class)
fit <- lm(spray~.,data=InsectSprays)
fit <- lm(count~spray,data=InsectSprays)
summary(fit)
summary(fit)['coef']
summary(fit)$coef
class(fit)
est <- summary(fit)$coef[,1]
mean(sA)
mean(sB)
fit <- lm(count~spray-1,data=InsectSprays)
nfit <- lm(count~spray-1,data=InsectSprays)
summary(nfit)
summary(nfit)$coef
spray2<-relevel(InsectSprays[1],"C")
InsectSPrays[1]
InsectSprays[1]
InsectSprays['spray']
spray2<-relevel(InsectSprays[1],\"C\")
spray2 <- relevel(InsectSprays$spray,\"C\")
spray2 <- relevel(InsectSprays$spray,"C")
fit2 <- lm(count~spray,spray2)
names(spray2)
spray2
fit2 <- lm(count ~ spray2, InsectSprays)
summary(fit2)$coef
mean(sC)
(fit$coef[2]-fit$coef[3])/1.6011
dim(hunger)
948
names(hunger)
fit<- lm(Numeric~Year,hunger)
summary(fit)
summary(fit)$coef
x[hunger$Sex=="Female"]
lmf<-lm(Numeric[Sex=="Female"] ~ Year[Sex=="Female"],hunger)
lmF<-lm(Numeric[Sex=="Female"] ~ Year[Sex=="Female"],hunger)
lmF<-lm(Numeric[Sex=="male"] ~ Year[Sex=="male"],hunger)
lmF<-lm(Numeric[Sex=="Female"] ~ Year[Sex=="Female"],hunger)
lmM<-lm(Numeric[Sex=="male"] ~ Year[Sex=="male"],hunger)
lmF
lmM
lmM<-lm(Numeric[Sex=="male"] ~ Year[Sex=="male"],hunger)
lmM
lmM<-lm(Numeric[Sex=="Male"] ~ Year[Sex=="Male"],hunger)
head(hunger)
lmBoth <- lm(Numeric ~ Year+Sex,hunger)
summary(lmBoth)
lmInter <- lm(Numeric~Year+Sex+Sex*Year,hunger)
summary(lmInter)
fit <- lm(y~x,out2)
plot(fit, which=1)
out2[-1, ]
fitno <- lm(y ~ x, out2[-1, ])
plot(residuals)
plot(fit,fitno,which=1)
plot(fitno, which=1)
coef(fitno)-coef(fit)
coef(fit)-coef(fitno)
View(dfbeta(fit))
resno <- out2[1, "y"] - predict(fitno, out2[1,])
1-resid(fit)[1]/resno
View(hatvalues(fit))
sigma
sigma <- sqrt(deviance(fit)/df.residual(fit))
sigma <- sqrt(deviance(fit)/df.residual(fit))
rstd <- resid(fit)/(sigma * sqrt(1-hatvalues(fit)))
head(cbind(rstd, rstandard(fit)))
plot(fit, which=3)
plot(fit, which=2)
plot(fit, which=2)
sigma1 <- sqrt(deviance(fitno)/df.residual(fitno))
resid(fit)[1]
resid(fit)[1]/(sigma1*sqrt(1-hatvalues(fit)[1]))
resid(fit)[1]/(sigma1*sqrt(1-hatvalues(fit)[1]))
head(rstudent(fit))
dy
predict(fitno, out2)
dy <- predict(fitno, out2)-predict(fit, out2)
dy <- predict(fitno, out2)-predict(fit, out2)
sum(dy^2)/(2*sigma^2)
plot(fit, which=5)
data(mtcars)
head(mtcars)
class(mtcars[1,])
class(mtcars$am)
lm(mpg~cyl+wt,mtcars)
lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
fit = lm(mpg ~ factor(cyl) + wt, mtcars)
summary(fit)$coef
factor(mtcars$cyl)
fit2 = lm(mpg ~ factor(cyl) , mtcars)
summary(fit2)$coef
fit2 = lm(mpg ~ factor(cyl)*wt , mtcars)
summary(fit2)$coef
fit = lm(mpg ~ factor(cyl) + wt, mtcars)
summary(fit)$coef
x = c(0.586, 0.166, -0.042, -0.614, 11.72)
y = c(0.549, -0.026, -0.127, -0.751, 1.344)
fit5 = lm(y ~ x)
hatvalues(fit)
hatvalues(fit5)
install.packages("devtools")
devtools::install_github("jhudsl/collegeIncome")
library(collegeIncome)
data(college)
devtools::install_github("jhudsl/matahari")
dance_start(value = FALSE, contents = FALSE)
library(matahari)
dance_start(value = FALSE, contents = FALSE)
dance_save("~/Desktop/college_major_analysis.rds")
names(matahari)
matahari
HEAD(MTCARS)
mtcars
mtcars
getwd()
list.files()
setwd('C:/Users/comp/Documents/CourseraR/Regression Models')
dir()
list.files()
list.files()
library(Metacars)
metacar
knitr::opts_chunk$set(echo = TRUE)
setwd('C:/Users/comp/Documents/CourseraR/Regression Models')
head(mtcars)
carsdata <- mtcars
head(carsdata)
summary(carsdata)
mdl1 <- lm(mpq~am,data=carsdata)
mdl1 <- lm(mpg~am,data=carsdata)
carsdata
carsdata$am
class(carsdata[,'am'])
as.factor(carsdata[,'am'])
carsdata[,'am']<-as.factor(carsdata[,'am'])
class(carsdata[,'am'])
carsdata[,'am']<-as.factor(carsdata[,'am'])
mdl1 <- lm(mpg~am,data=carsdata)
plot(mdl1)
summary(mdl1)
mdl1 <- lm(mpg~am,data=carsdata)
mdl2 <- lm(mpg~am+gear,data=carsdata)
mdl3 <- lm(mpg~am+gear+cyl,data=carsdata)
mdl4 <- lm(mpg~.,data=carsdata)
mdl1 <- lm(mpg~am,data=carsdata)
mdl2 <- lm(mpg~.,data=carsdata)
coef(mdl1)
coef(mdl2)
mdl1 <- lm(mpg~am,data=carsdata)
mdl2 <- lm(mpg~.,data=carsdata)
coef(mdl1)
\n
mdl1 <- lm(mpg~am,data=carsdata)
mdl2 <- lm(mpg~.,data=carsdata)
coef(mdl1)
print("\n")
coef(mdl2)
mdl1 <- lm(mpg~am,data=carsdata)
mdl2 <- lm(mpg~.,data=carsdata)
coef(mdl1)
print("  ")
coef(mdl2)
mdl1 <- lm(mpg~am,data=carsdata)
mdl2 <- lm(mpg~.,data=carsdata)
coef(mdl1)
coef(mdl2)
summary(mdl1)
summary(mdl1)
confint(mdl1)
betahat <- 7.245
SE <- 1.764
tstar <- qt(1-0.05/2, df = length(mtcars$mpg) - 2)
c(betahat - tstar*SE, betahat + tstar *SE)
qt(1-0.05/2, df = length(mtcars$mpg) - 2)
pt(95,df = length(mtcars$mpg) - 2)
pt(0.05,df = length(mtcars$mpg) - 2)
?pt
summary(mdl2)
pt(0.657)
pt(0.657,8)
dim(mtcars)
pt(0.657,9)
pt(0.657/2,9)
anova(mdl1,mdl2)
confint(mdl2)
confint(mdl2)[9]
confint(mdl2)[9,]
confint(mdl2)[9,]
par(mfrow=c(2,2))
plot(mdl1);
abline(mdl1)
par(mfrow=c(2,2))
plot(mdl2);
abline(mdl2$intercept)
vif(mdl1,mdl2)
?vif
VIF(mdl1,mdl2)
VIF(mdl2)
vif(mdl2)
